<% content_for :title do %>Bar Chart by OpenAdTools<% end %>
<% content_for :description do %>Paste your data straight from excel and instantly create a slick-looking bar chart.<% end %>

<div class="page-header">
  <h1>Bar Chart</h1>
  <p class="lead">Paste your data straight from excel and instantly create a slick-looking bar chart.</p>
</div>

<br>

<div id="chart"></div>

<br><hr>

<form onsubmit="return false;">
	<button class="submit btn btn-primary btn-lg" onclick="graph();" >Update Chart</button>
	<br><br>
	<h3>Input Data <small>(paste your data straight from excel)</small></h3>
	<div class="col-md-4">
	<textarea class="form-control" rows="10" id="textinput" placeholder="Paste the data you want to display as a bar chart here..." autofocus >5
10
13
19
21
25
22
18
15
13
11
12
15
20
18
17
16
18
23
25</textarea>
<br><br><br>
</div>
</form>


<script type="text/javascript">

var w = 800; // Width
var h = 200; // Height
var p = 1;   // Padding

//Create SVG element
var svg = d3.select("#chart")
            .append("svg")
            .attr("width", w)
            .attr("height", h);

var dataset = document.getElementById('textinput').value.split("\n");
// [ 5, 10, 13, 19, 21, 25, 22, 18, 15, 13,
//  11, 12, 15, 20, 18, 17, 16, 18, 23, 25 ];
var l = dataset.length;

svg.selectAll("rect")
   .data(dataset)
   .enter()
   .append("rect")
   .attr("x", function(d, i) {
      return i * (w / l);
    })
   .attr("y", function(d) {
      return h - d * 4;
    })
   .attr("width", w / l - p)
   .attr("height", function(d) {
      return d * 4;
    });

// Create data labels
svg.selectAll("text")
   .data(dataset)
   .enter()
   .append("text")
   .text(function(d) {
      return d;
   })
   .attr("x", function(d, i) {
      return i * (w / l) + (w / l - p) / 2;
    })
   .attr("y", function(d) {
      return h - (d * 4) + 14;
    })
   .attr("font-family", "sans-serif")
   .attr("font-size", "11px")
   .attr("fill", "white")
   .attr("text-anchor", "middle");

// Function to update graph
function graph() {
	
	dataset = document.getElementById('textinput').value.split("\n");
	l = dataset.length;

	svg.selectAll("rect").remove();
	svg.selectAll("text").remove();

	svg.selectAll("rect")
	   .data(dataset)
	   .enter()
	   .append("rect")
	   .attr("x", function(d, i) {
	      return i * (w / l);
	    })
	   .attr("y", function(d) {
	      return h - d * 4;
	    })
	   .attr("width", w / l - p)
	   .attr("height", function(d) {
	      return d * 4;
	    });

	svg.selectAll("text")
   .data(dataset)
   .enter()
   .append("text")
   .text(function(d) {
      return d;
   })
   .attr("x", function(d, i) {
      return i * (w / l) + (w / l - p) / 2;
    })
   .attr("y", function(d) {
      return h - (d * 4) + 14;
    })
   .attr("font-family", "sans-serif")
   .attr("font-size", "11px")
   .attr("fill", "white")
   .attr("text-anchor", "middle");
}



</script>